<!DOCTYPE html><html lang="en" class="bg-gradient-to-br from-green-100 via-white to-green-200 text-green-900"><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Statistical Analysis App</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jstat/1.9.4/jstat.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    canvas {
      width: 100% !important;
      height: auto !important;
    }
    @media (min-width: 768px) {
      .container {
        max-width: 768px;
        margin: auto;
      }
    }
    .section-title {
      @apply text-xl font-semibold mb-2 mt-6 border-b pb-1 border-green-300;
    }
    .button-set button {
      @apply bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition-all;
    }
    .fade-in {
      animation: fadeIn 1s ease-in-out;
    }
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .tooltip {
      position: relative;
      display: inline-block;
      cursor: pointer;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: max-content;
      background-color: #4B5563;
      color: #fff;
      text-align: center;
      padding: 4px 8px;
      border-radius: 4px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.75rem;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body class="p-4 md:p-6 font-sans bg-gradient-to-br from-green-100 via-white to-green-200 text-green-900 min-h-screen">
  <div class="container fade-in">
    <h1 class="text-3xl md:text-4xl font-extrabold mb-6 text-center"><i class="fas fa-chart-line text-green-700"></i> SmartStat: Interactive Statistical Analysis</h1>
    <div class="flex flex-col sm:flex-row gap-3 mb-6 justify-center items-center fade-in">
      <div class="tooltip">
        <input type="file" id="fileInput" accept=".csv,.xlsx" class="bg-green-50 border border-green-400 p-2 rounded shadow-sm w-full sm:w-auto" />
        <span class="tooltiptext">Upload your CSV or Excel file</span>
      </div>
      <div class="tooltip">
        <button onclick="runAnalysis()" id="runBtn" class="bg-green-700 text-white px-6 py-2 rounded shadow hover:bg-green-800 transition"><i class="fas fa-play mr-2"></i>Run Analysis</button>
        <span class="tooltiptext">Click to process and analyze your data</span>
      </div>
    </div><div id="summary" class="fade-in tooltip" title="View descriptive statistics summary"></div>
<div id="regression" class="fade-in tooltip" title="Linear regression model and coefficients"></div>
<div id="correlation" class="fade-in tooltip" title="Correlation matrix (Pearson)"></div>

<div class="my-8 fade-in">
  <h2 class="section-title"><i class="fas fa-table mr-2"></i>Interactive Table</h2>
  <div class="overflow-x-auto tooltip" title="Filter and search table data">
    <table id="dataTable" class="display w-full text-sm"></table>
  </div>
</div>

  </div>  <script>
    let data = [];

    document.getElementById('fileInput').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();

      reader.onload = function (e) {
        Papa.parse(e.target.result, {
          header: true,
          dynamicTyping: true,
          complete: function (results) {
            data = results.data.filter(row => Object.values(row).some(v => v !== null && v !== ""));
            buildTable(data);
          }
        });
      };
      reader.readAsText(file);
    });

    function buildTable(data) {
      const table = document.getElementById('dataTable');
      table.innerHTML = "";

      if (!data.length) return;
      const headers = Object.keys(data[0]);
      const thead = `<thead><tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr></thead>`;
      const tbody = `<tbody>${data.map(row => `<tr>${headers.map(h => `<td>${row[h]}</td>`).join('')}</tr>`).join('')}</tbody>`;
      table.innerHTML = thead + tbody;
      new DataTable('#dataTable');
    }

    function runAnalysis() {
      if (!data.length) {
        alert("No data loaded.");
        return;
      }

      const headers = Object.keys(data[0]);
      const numeric = headers.filter(h => typeof data[0][h] === "number");

      if (numeric.length < 2) {
        alert("Need at least two numeric columns.");
        return;
      }

      const summary = numeric.map(col => {
        const values = data.map(d => d[col]);
        const mean = jStat.mean(values).toFixed(2);
        const min = Math.min(...values);
        const max = Math.max(...values);
        return `<li><b>${col}:</b> Mean = ${mean}, Min = ${min}, Max = ${max}</li>`;
      }).join("");

      document.getElementById('summary').innerHTML = `<h2 class="section-title">Summary Statistics</h2><ul class="list-disc pl-5">${summary}</ul>`;

      let corrHTML = `<h2 class="section-title">Correlation Matrix</h2><table class="table-auto border-collapse border">`;
      corrHTML += `<tr><th></th>${numeric.map(h => `<th>${h}</th>`).join('')}</tr>`;
      numeric.forEach(col1 => {
        corrHTML += `<tr><th>${col1}</th>`;
        numeric.forEach(col2 => {
          const v1 = data.map(d => d[col1]);
          const v2 = data.map(d => d[col2]);
          const r = jStat.corrcoeff(v1, v2).toFixed(2);
          corrHTML += `<td class="border px-2">${r}</td>`;
        });
        corrHTML += `</tr>`;
      });
      corrHTML += `</table>`;
      document.getElementById('correlation').innerHTML = corrHTML;

      const y = data.map(d => d[numeric[0]]);
      const x = data.map(d => d[numeric[1]]);
      const model = jStat.models.linear(x, y);
      const slope = model.coef[1].toFixed(3);
      const intercept = model.coef[0].toFixed(3);

      document.getElementById('regression').innerHTML = `<h2 class="section-title">Simple Linear Regression</h2><p>${numeric[0]} = ${intercept} + ${slope} * ${numeric[1]}</p>`;
    }
  </script></body>
</html>